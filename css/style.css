:root {
    interpolate-size: allow-keywords;

    --toggle-bg-light: #ffffff;
    --toggle-bg-dark: #1f2937;

    --toggle-text-light: #374151;
    --toggle-text-dark: #d1d5db;

    --sun-color: hsl(43, 97%, 55%);
    --moon-color: hsl(234, 87%, 73%);

    --shadow-light-outer-light: -5px -5px 10px rgba(255, 255, 255, 0.7);
    --shadow-dark-outer-light: 5px 5px 10px #d1d5db;
    --shadow-light-inner-light: inset -3px -3px 6px rgba(255, 255, 255, 0.7);
    --shadow-dark-inner-light: inset 3px 3px 6px #d1d5db;

    --shadow-light-outer-dark: -5px -5px 10px #2e3d51;
    --shadow-dark-outer-dark: 5px 5px 10px #111827;
    --shadow-light-inner-dark: inset -3px -3px 6px #2e3d51;
    --shadow-dark-inner-dark: inset 3px 3px 6px #111827;

    --gradient-light: var(--toggle-bg-light);
    --gradient-dark: var(--toggle-bg-dark);

    --transition-speed: 0.5s;
    --transition-bounce: cubic-bezier(0.68, -0.55, 0.27, 1.55);

    --body-bg-light: #F3F4F6;
    --body-text-light: #111827;
    --body-bg-dark: #111827;
    --body-text-dark: #F3F4F6;
}


@view-transition {
    navigation: auto;
}

::view-transition-group(root),
::view-transition-image-pair(root) {
    position: absolute;
    top: 0;
    left: 0;

    animation-duration: 1.4s;
    animation-fill-mode: both;
}

::view-transition-old(main) {
    animation: main-out 0.4s ease-in both;
}

::view-transition-new(main) {
    animation: main-in 0.4s ease-out both;
}

@keyframes main-out {
    from {
        opacity: 1;
        transform: translateY(0);
    }

    to {
        opacity: 0;
        transform: translateY(-20px);
    }
}

@keyframes main-in {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}


html.dark {
    text {
        fill: #d9d9d9;
    }
}

.theme-toggle-container {
    display: flex;
    align-items: center;
    margin-right: 1rem;
}

.toggle {
    position: relative;
    width: 73px;
    height: 33px;
    border-radius: 100vh;
    cursor: pointer;
    transition: background var(--transition-speed) ease,
        box-shadow var(--transition-speed) ease,
        transform 0.1s ease;
    background: var(--gradient-light);
    box-shadow: var(--shadow-light-inner-light), var(--shadow-dark-inner-light);
    display: flex;
    align-items: center;
    padding: 0 4px;
    overflow: hidden;
    outline: 1px solid #8080806e;

    html.dark & {
        background: var(--gradient-dark);
        box-shadow: var(--shadow-light-inner-dark), var(--shadow-dark-inner-dark);
    }

    &:active {
        transform: scale(0.97);
    }

    input {
        display: none;

        &:checked+.slider .slider-icon {
            transform: translateX(calc(100% + 13px));
        }

        &:checked:active+.slider .slider-icon {
            transform: scale(0.95) translateX(calc(100%));
        }

        &:not(:checked):active+.slider .slider-icon {
            transform: scale(0.95) translateX(0px);
        }
    }
}

.slider {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    height: 100%;
    padding: 0 8px;
    position: relative;
    z-index: 1;
}

.slider-icon {
    position: absolute;
    height: 25px;
    width: 25px;
    background: hsl(from var(--moon-color) h s 95%);
    border-radius: 50%;
    transition: transform var(--transition-speed) var(--transition-bounce),
        background var(--transition-speed) ease,
        box-shadow var(--transition-speed) ease;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    left: 1px;
    top: 4px;
    pointer-events: none;
    outline: 1px solid #80808040;
    box-shadow: var(--shadow-light-outer-light), var(--shadow-dark-outer-light);

    html.dark & {
        background: var(--toggle-bg-dark);
        box-shadow: var(--shadow-light-outer-dark), var(--shadow-dark-outer-dark);
    }
}

.sun-icon,
.moon-icon {
    width: 18px;
    height: 18px;
    transition: color var(--transition-speed) ease, opacity var(--transition-speed) ease, filter var(--transition-speed) ease;
    filter: drop-shadow(0 0 1px rgba(0, 0, 0, 0.1));
    overflow: visible;
}

.sun-icon {
    opacity: 1;
    filter: drop-shadow(0 0 2px var(--sun-color));
    color: var(--sun-color);

    circle {
        fill: var(--sun-color);
        transition: fill var(--transition-speed) ease;
    }

    line {
        stroke: var(--sun-color);
        transition: stroke var(--transition-speed) ease;
    }

    html.dark & {
        filter: drop-shadow(0 0 1px rgba(0, 0, 0, 0.1));
        color: var(--sun-color);

        circle {
            fill: var(--sun-color);
        }

        line {
            stroke: var(--sun-color);
        }
    }
}

.moon-icon {
    color: var(--moon-color);

    path {
        fill: var(--moon-color);
        transition: fill var(--transition-speed) ease;
    }

    html.dark & {
        opacity: 1;
        filter: drop-shadow(0 0 3px var(--moon-color));
        color: var(--moon-color);

        path {
            fill: var(--moon-color);
        }
    }
}

#sidebar {
    width: calc-size(max-content, size + 1rem) !important;
    /* transition: all 0.5s ease-in-out allow-discrete; */

    &:not(.collapsed) .menu-text {
        opacity: 1;
        display: block;
        transition: all 0.5s ease-in allow-discrete;

        @starting-style {
            opacity: 0;
        }
    }

    &:is(.collapsed) {

        &::after {
            content: '';
            position: absolute;
            min-height: 100%;
            width: 1px;
            position-area: left;
            left: 100%;
            background: hsl(217, 21%, 27%);
        }

        width: 4rem !important;

        #logo {
            display: none;
        }

        #desktopMenuToggle {
            margin-left: -0.4ch;
        }

        .menu-text {
            display: none;
            opacity: 0;
            /* transition: all 0.5s ease-out allow-discrete; */
        }

        .menu-item {
            position: relative;
            width: fit-content;

            a {
                width: 3rem;

                &:hover {
                    border-radius: 0.5rem 0 0 0.5rem;
                }
            }

            &:hover .menu-hover-area {
                display: block !important;
            }
        }

        .menu-hover-area {
            position: absolute;
            left: 100%;
            top: 0;
            width: max-content;
            background: white;
            /* border-width: 2px; */
            border: 2px solid hsl(217, 21%, 27%);
            border-radius: 0 0.45rem 0.45rem 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 50;
            display: none;

            &:has(.submenu-hover) {
                /* border-width: 0px; */

                span {
                    border-top-right-radius: 4px;
                }

                .submenu-hover {
                    border-bottom-right-radius: 4px;
                }

            }

            span {
                border-radius: 0;
            }

            .submenu-hover {
                position: static;
                display: block;
                padding-left: 1rem;

                a {
                    width: fit-content;
                }
            }
        }

        .submenu-click {
            display: none;
        }
    }
}

html:not(.dark) {
    #sidebar:is(.collapsed) {

        &::after {
            content: '';
            position: absolute;
            min-height: 100%;
            width: 1px;
            position-area: left;
            left: 100%;
            background: #e5e7eb;
        }

        .menu-hover-area {
            border: 2px solid var(--toggle-bg-light);

            span {
                border-radius: 0 100vh 100vh 0;
            }
        }
    }
}


.submenu-hover {
    display: none;
}

.submenu-click {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease-out allow-discrete;
    background: transparent;
    padding-left: 2rem;

    &.open {
        max-height: fit-content;
        transition: max-height 0.5s ease-in allow-discrete;
    }
}

.submenu-arrow {
    transition: transform 0.3s ease allow-discrete;

    &.rotate {
        transform: rotate(180deg);
    }
}

.menu-item::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 20px;
    height: 100%;
    background: transparent;
}

@media (width<768px) {
    #sidebar {
        min-height: -webkit-fill-available;
        min-height: -moz-available;
        min-height: fill-available;

        +* {
            position: absolute;
            min-width: 100%;

            #mobileMenuToggle {
                position: relative;
                z-index: 99999;
            }
        }

        &[style="width: 16rem;"] {
            z-index: 9999;
            position: fixed;
            width: calc-size(max-content, size + 1rem) !important;
            display: block;
            opacity: 1;
            transition: all 0.5s ease-in allow-discrete;

            +* {
                #mobileMenuToggle {
                    transform: translateX(10rem);
                }
            }
        }

        &[style="width: 0px;"] {
            width: 0px !important;
            display: none;
            opacity: 0;
            transition: all 0.5s ease-out allow-discrete;

            +* {
                #mobileMenuToggle {
                    transform: translateX(0rem);
                }
            }
        }
    }

    #sidebar .mobile-toggle-icon {
        transition: transform 3.3s ease allow-discrete;

        .mobile-toggle-active & {
            transform: rotate(180deg);
        }
    }

    .menu-hover-area {
        display: none;
    }
}

@media (width>=768px) {
    #sidebar:not(.collapsed) {
        .menu-hover-area {
            display: none;
        }
    }
}